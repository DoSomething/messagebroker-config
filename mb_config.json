{"rabbit":[
  {
    "__comment" : "General RabbitMQ configuration. Define the exchanges and related queues. Note that it possible for more than one change to send messages to a queue through the 'exclusive' setting. The hierarchy in the structure of this file is an effort to make the process easier rather a set of strict rules.",
    "exchanges":[
    {
      "__comment" : "All transactional email events from the Drupal application go to this exchange.",
      "name" : "transactionalExchange",
      "type" : "topic",
      "passive" : "0",
      "durable" : "1",
      "auto_delete" : "0",
      "queues" : [
        {
          "__comment" : "Email events, queue items are used to generate single transaction request to Mandrill.",
          "name" : "transactionalQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "transactional",
          "binding_pattern" : "*.*.transactional",
          "consume" : [
            {
              "tag" : "transactional",
              "no_local" : "0",
              "no_ack" : "0",
              "nowait" : "0"
            }
          ]
        },
        {
          "__comment" : "The real time dashboard application consumes this queue to generate visual stats of the membership activity.",
          "name" : "activityStatsQueue",
          "passive" : "0",
          "durable" : "0",
          "exclusive" : "1",
          "auto_delete" : "0",
          "routing_key" : "activityStats",
          "binding_pattern" : "*.*.transactional",
          "consume" : [
            {
              "tag" : "activityStats",
              "no_local" : "0",
              "no_ack" : "0",
              "exclusive" : "0",
              "nowait" : "1"
            }
          ]
        },
        {
          "__comment" : "Mongo based logging of all transactions.",
          "name" : "loggingQueue",
          "passive" : "0",
          "durable" : "0",
          "exclusive" : "1",
          "auto_delete" : "0",
          "routing_key" : "logging",
          "binding_pattern" : "*.*.transactional",
          "consume" : [
            {
              "tag" : "logging",
              "no_local" : "0",
              "no_ack" : "1",
              "exclusive" : "0",
              "nowait" : "1"
            }
          ]
        },
        {
          "__comments" : "Submit user registration details to Mailchimp.",
          "name" : "userRegistrationQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "logging",
          "binding_pattern" : "user.registration.*"
        },
        {
          "__comment" : "All transactions with mobile information is submitted to Mobile Commons.",
          "name" : "mobileCommonsQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "logging",
          "binding_pattern" : "user.registration.*",
          "consume" : [
            {
              "tag" : "mobile",
              "no_local" : "0",
              "no_ack" : "0",
              "exclusive" : "0",
              "nowait" : "0"
            }
          ]
        },
        {
          "__comment" : "All member campaign activity is added to the user account on Mailchimp.",
          "name" : "mailchimpCampaignSignupQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "mailchimpCampaignSignup",
          "binding_pattern" : "campaign.signup.*"
        },
        {
          "__comment" : "Adds campaign activity (campaign signup and report backs) to mb-users database.",
          "name" : "userCampaignActivityQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "userCampaignActivty",
          "binding_pattern" : "campaign.*.*"
        },
        {
          "__comment" : "New user registrations information is added to the mb-user database.",
          "name" : "userAPIRegistrationQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "userAPIRegistration",
          "binding_pattern" : "user.registration.#"
        },
        {
          "__comment" : "All user campaign activity (signups and report backs) is added to the mb-user database.",
          "name" : "userAPICampaignActivityQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "userAPICampaignActivity",
          "binding_pattern" : "campaign.*.*"
        },
        {
          "__comment" : "When email accounts are added or updated on Mailchimp a status is returned including any errors or issues that will prevent sending further messages to the email address. This queue logs these issues and updates the mb-user database.",
          "name" : "userMailchimpStatusQueue",
          "passive" : "0",
          "durable" : "1",
          "exclusive" : "0",
          "auto_delete" : "0",
          "routing_key" : "userMailchimpStatus",
          "binding_pattern" : "*.mailchimp.error"
        }
      ]
    }
  ]}
]}


